{% extends 'base.html' %}

{% block title %}Registration{% endblock %}

{% block content %}
<!--You need this load static tag to make it work-->
{% load static %}
    <section class="page-title">
        {{results.title}}&nbsp;({{results.release_date}}, {{results.runtime}} mins)
    </section>

    <!-- Section used for displaying 'More Description' results -->
        {% if status == 'failure' %}
         <section class="errors">
            <div id="movies-error">
                OOPS...<br>
                Failed to retrieve data. Try again!
            </div>
        </section>
        {% elif status == 'databaseError' %}
        <section class="errors">
            <div id="database-error">
                OOPS...<br>
                We are experiencing problems with our database. Sorry for the inconvenience.
            </div>
        {% else %}
            <section class="displaying-movie-description">
                <table id="movie-view">
                    <tr>
                        <td>
                            <img src="{{image_path}}{{results.poster_path}}"}} onerror="this.src='{% static "img/no_image_available_big.png" %}';">
                        </td>
                        <td>
                            <div>
                                <table id="containerS3">
                                    <tr>
                                        <td>
                                            {% if rating.rating__avg < 3.0 %}
                                                <img src="{% static "img/average_bad_star.png" %}">
                                            {% else %}
                                                <img src="{% static "img/average_good_star.png" %}">
                                            {% endif %}
                                            <p>
                                                <span id="average_rate">{{rating.rating__avg}}/</span>
                                                <span id="max_star">5.0</span>
                                            </p>
                                        </td>
                                        <td>
                                            {% if video_link == 'No Trailer Found'%}
                                                <img src="{% static "img/no_trailer_button.png" %}">
                                                <p id="label_play_trailer">No Trailer Found</p>
                                            {% else %}
                                                <a href={{video_link}}>
                                                    <input type="image" name="Trailer_button" src="{% static "img/play_trailer_button.png" %}">
                                                </a>
                                                <p id="label_play_trailer">Play Trailer</p>
                                            {% endif %}
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <span class="tagline">{{results.tagline}}</span><br><br><br>
                            <span class="overview">
                                {{results.overview}}
                            </span><br><br>
                            <p style="color:white;">{{results.genre}}Genres: {% for name in genre %} {{ name }} {% endfor %}</p>

                            {% if user.is_authenticated %}
                                <div class="star">
                                  <form method="POST" action="/rated/">
                                      {% csrf_token %}
                                    <input class="star star-5" id="star-5" type="radio" name="star" value="5" onchange="this.form.submit();" {% if current_rating == '5' %} checked{% endif %}/>
                                    <label class="star star-5" for="star-5"></label>
                                    <input class="star star-4" id="star-4" type="radio" name="star" value="4" onchange="this.form.submit();" {% if current_rating == '4' %} checked{% endif %}/>
                                    <label class="star star-4" for="star-4"></label>
                                    <input class="star star-3" id="star-3" type="radio" name="star" value="3" onchange="this.form.submit();"{% if current_rating == '3' %} checked{% endif %}/>
                                    <label class="star star-3" for="star-3"></label>
                                    <input class="star star-2" id="star-2" type="radio" name="star" value="2" onchange="this.form.submit();"{% if current_rating == '2' %} checked{% endif %}/>
                                    <label class="star star-2" for="star-2"></label>
                                    <input class="star star-1" id="star-1" type="radio" name="star" value="1" onchange="this.form.submit();"{% if current_rating == '1' %} checked{% endif %}/>
                                    <label class="star star-1" for="star-1"></label><input type="hidden" value={{results.id}} name="id_movie"}>
                                  </form>
                                </div><br><br>
                            {% endif %}
                            
                        </td>
                    </tr>
                </table>
            </section>
        {% endif %}
{% endblock %}